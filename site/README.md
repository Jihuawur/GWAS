This is the source for the lab website.  It includes HTML, CSS and JS
files for the basic site and a Makefile for (1) moving the html
generated by the knitr process in ../R into the website and (2)
deploying the site to a remote server.

# How to edit

The files that are used in the web site are found in the `source`
subdirectory.  Most of the handwritten content for the site are found
in files ending in *.md*.  (Some are in files with other extensions,
namely *.erb* and *.haml*, which are templating languages.)

This system uses *kramdown* as its markdown engine.  Different
markdown systems are very similar, but kramdown has its own
[quick reference manaual](http://kramdown.gettalong.org/quickref.html).

The only note of interest is that this site uses the
[bootstrap](http://getbootstrap.com) style sheets, which means that
there are certain classes that can be assigned to HTML elements for
consistent look, for example the class `.page-header` might be applied
to the top section of a page and a thin horizontal line is drawn below
it.  You can add class attributes in kramdown with {:.page-header} on
the line immediately below the element.

# Build information

This site requires ruby.  I suggest not modifying the system ruby.
You can accomplish this by either using a ruby version manager or
installing a local ruby.  But the easiest is just to add the line
"gem: --user-install" to your ~/.gemrc.

Also, because we're not deploying the gems, let's just keep copies in
our local home dir.  Run `bundle config path ~/.vendor/bundle` once.

This uses [middleman](http://middlemanapp.com) to create a static
website from pieces.  To install middleman run `gem install
middleman`.

This site directory was created using `middleman init site`.

To work on the site, cd into *site* and then run `middleman`, which
starts up a server that automatically refreshes with updated pages as
you edit the templates, parts, etc.

To create the static website to deploy, run `middleman build`, which
will create files under *build* that can be copied to a website.

To push the built website to the remote server on stat-gen.org, I use
the rsync deploy method (see config.rb for settings).  `middleman
deploy` will syncronize the remote server with the *build* directory.
In order for this to work, you must have your public key stored on the
remote server.

# Random Notes

The str tutorials are derived from a separate process of knitr files
that generate HTML and then thrown over the wall.  I first rename them
using something like this in the mod4_post_analytics folder:

for i in *.html; do mv $i Mod4_$i.erb; done

Then I strip everything before and after the body tags, inclusive.

perl -i.bak -ne 'BEGIN { $b=0 }; if (/<\/body>/) { $b=!$b }; print if $b; if (/<body>/) { $b=!$b }' ./*.erb

Then I copied them.

cp *.erb ~/src/GWAS/site/source/str

But then I had to manually update the layout.haml file with the custom menu.
